{
  if (StringUtils.isEmpty(location)) {
    throw new RuntimeException("Agent should not register without installation path.");
  }
  AgentStatus status=AgentStatus.fromConfig(AgentConfigStatus.Pending);
  if (SystemUtil.isLocalIpAddress(agentConfig.getIpAddress()) || registeredAlready) {
    status=AgentStatus.Idle;
  }
  AgentRuntimeInfo agentRuntimeInfo=new AgentRuntimeInfo(agentConfig.getAgentIdentifier(),status,location);
  agentRuntimeInfo.setUsableSpace(usablespace);
  agentRuntimeInfo.operatingSystemName=operatingSystem;
  return agentRuntimeInfo;
}
