{
  new SystemEnvironment().setProperty("os.name","minix");
  String url="http://cruise.com/go";
  HttpClient httpClient=Mockito.mock(HttpClient.class);
  final DefaultAgentRegistry defaultAgentRegistry=new DefaultAgentRegistry();
  Properties properties=new Properties();
  properties.put(AgentRegistrationPropertiesReader.AGENT_AUTO_REGISTER_KEY,"t0ps3cret");
  properties.put(AgentRegistrationPropertiesReader.AGENT_AUTO_REGISTER_RESOURCES,"linux, java");
  properties.put(AgentRegistrationPropertiesReader.AGENT_AUTO_REGISTER_ENVIRONMENTS,"uat, staging");
  properties.put(AgentRegistrationPropertiesReader.AGENT_AUTO_REGISTER_HOSTNAME,"agent01.example.com");
  remoteRegistryRequester(url,httpClient,defaultAgentRegistry).requestRegistration("cruise.com",new AgentRegistrationPropertiesReader(properties));
  verify(httpClient).executeMethod(argThat(hasAllParams(defaultAgentRegistry.uuid())));
}
