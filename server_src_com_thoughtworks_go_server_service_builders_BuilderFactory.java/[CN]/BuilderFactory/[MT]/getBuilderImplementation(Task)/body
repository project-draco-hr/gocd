{
  if (!taskBuilderMap.containsKey(task.getClass()))   throw new RuntimeException("Unexpected type of task: " + task.getClass());
  return taskBuilderMap.get(task.getClass());
}
