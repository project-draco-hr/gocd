{
  Document doc=n.getOwnerDocument();
  XmlDocument xmlDoc=(XmlDocument)getCachedNode(doc);
  NokogiriNamespaceCache nsCache=xmlDoc.getNamespaceCache();
  int oldHash=n.hashCode();
  Node result=doc.renameNode(n,namespaceURI,qualifiedName);
  if (result != n) {
    nsCache.replaceNode(n,result);
  }
  return result;
}
