{
  GitMaterialConfig git=new GitMaterialConfig("url");
  MaterialConfig svn=cruiseConfig.getPipelineConfigByName(new CaseInsensitiveString("P1")).materialConfigs().get(0);
  PipelineConfig p1=new PipelineConfig(new CaseInsensitiveString("P1"),new MaterialConfigs(git),new StageConfig(),new StageConfig());
  configCache.onPipelineConfigChange(p1);
  assertThat(configCache.getPipelineConfig("P1"),is(p1));
  MaterialConfigs matchingGitMaterials=configCache.getMatchingMaterialsFromConfig(git.getFingerprint());
  assertThat(matchingGitMaterials.size(),is(1));
  assertThat(matchingGitMaterials.contains(git),is(true));
  MaterialConfigs matchingSvnMaterials=configCache.getMatchingMaterialsFromConfig(svn.getFingerprint());
  assertThat(matchingSvnMaterials.size(),is(2));
}
