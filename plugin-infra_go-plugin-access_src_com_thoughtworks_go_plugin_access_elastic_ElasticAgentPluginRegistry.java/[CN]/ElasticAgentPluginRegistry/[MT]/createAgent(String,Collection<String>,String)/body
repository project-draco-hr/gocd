{
  PluginDescriptor plugin=findPluginMatching(resources,environment);
  if (plugin != null) {
    LOGGER.debug("Processing create agent for plugin: {} with resources: [{}] and environment: {}",plugin.id(),resources,environment);
    elasticAgentExtension.createAgent(autoRegisterKey,plugin.id(),resources,environment);
    LOGGER.debug("Done processing create agent for plugin: {} with resources: [{}] and environment: {}",plugin.id(),resources,environment);
  }
 else {
    LOGGER.warn("Could not find plugin matching resources: [{}] and environment: {}",resources,environment);
  }
}
