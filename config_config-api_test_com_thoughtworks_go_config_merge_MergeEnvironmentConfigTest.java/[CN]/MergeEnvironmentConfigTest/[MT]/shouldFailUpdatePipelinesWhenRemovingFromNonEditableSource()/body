{
  BasicEnvironmentConfig uatLocalPart=new BasicEnvironmentConfig(new CaseInsensitiveString("UAT"));
  uatLocalPart.setOrigins(new FileConfigOrigin());
  BasicEnvironmentConfig uatRemotePart=new BasicEnvironmentConfig(new CaseInsensitiveString("UAT"));
  uatRemotePart.setOrigins(new RepoConfigOrigin());
  uatRemotePart.addPipeline(new CaseInsensitiveString("baz"));
  pairEnvironmentConfig=new MergeEnvironmentConfig(uatLocalPart,uatRemotePart);
  try {
    pairEnvironmentConfig.setConfigAttributes(new SingletonMap(BasicEnvironmentConfig.PIPELINES_FIELD,Arrays.asList(new SingletonMap("name","foo"),new SingletonMap("name","bar"))));
  }
 catch (  Exception ex) {
    assertThat(ex.getMessage(),startsWith("Cannot remove pipeline baz from environment UAT because it is defined in non-editable source"));
  }
  assertThat(pairEnvironmentConfig.getPipelineNames(),is(Arrays.asList(new CaseInsensitiveString("baz"))));
}
