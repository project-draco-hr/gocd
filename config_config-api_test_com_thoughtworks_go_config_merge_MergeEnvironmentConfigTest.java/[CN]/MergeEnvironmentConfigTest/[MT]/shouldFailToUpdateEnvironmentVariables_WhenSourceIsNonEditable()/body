{
  BasicEnvironmentConfig uatLocalPart=new BasicEnvironmentConfig(new CaseInsensitiveString("UAT"));
  uatLocalPart.setOrigins(new FileConfigOrigin());
  BasicEnvironmentConfig uatRemotePart=new BasicEnvironmentConfig(new CaseInsensitiveString("UAT"));
  uatRemotePart.setOrigins(new RepoConfigOrigin());
  uatRemotePart.addEnvironmentVariable("hello","world");
  environmentConfig=new MergeEnvironmentConfig(uatLocalPart,uatRemotePart);
  try {
    environmentConfig.setConfigAttributes(new SingletonMap(BasicEnvironmentConfig.VARIABLES_FIELD,Arrays.asList(envVar("foo","bar"),envVar("baz","quux"))));
  }
 catch (  Exception ex) {
    assertThat(ex.getMessage(),startsWith("Cannot remove variable hello from environment UAT because it is defined in non-editable source"));
  }
  assertThat(environmentConfig.getVariables(),hasItem(new EnvironmentVariableConfig("hello","world")));
  assertThat(environmentConfig.getVariables().size(),is(1));
}
