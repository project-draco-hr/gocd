{
  String configFileContent="test";
  String message="Invalid Config file";
  GoConfigService.XmlPartialSaver partialSaver=mock(GoConfigService.XmlPartialSaver.class);
  when(mockGoConfigService.fileSaver(false)).thenReturn(partialSaver);
  when(partialSaver.saveXml(configFileContent,"md5")).thenReturn(GoConfigValidity.invalid(new RuntimeException(message)));
  ModelAndView modelAndView=controller.handleEditConfiguration(configFileContent,"md5",null,request);
  verify(partialSaver).saveXml(configFileContent,"md5");
  assertThat((String)modelAndView.getModelMap().get(GoConstants.ERROR_FOR_PAGE),is(message));
}
