{
synchronized (RuntimeInfo.class) {
    if (runtime1.get() == runtime) {
      return info1;
    }
 else     if (runtime1.get() == null) {
      runtime1=new WeakReference<Ruby>(runtime);
      info1=new RuntimeInfo(runtime);
      return info1;
    }
 else {
      if (runtimes == null) {
        runtimes=new WeakHashMap<Ruby,RuntimeInfo>(1);
      }
      RuntimeInfo cache=runtimes.get(runtime);
      if (cache == null) {
        cache=new RuntimeInfo(runtime);
        runtimes.put(runtime,cache);
      }
      return cache;
    }
  }
}
