{
  String content="<cruise schemaVersion='" + CONFIG_SCHEMA_VERSION + "'>\n"+ "<server artifactsdir='artifacts' >"+ "<security>\n"+ "      <passwordFile path=\"/etc/cruise/password.properties\" />\n"+ "      <roles>\n"+ "        <role name=\"bar\">\n"+ "          <users>"+ "             <user>foo</user>"+ "          </users>"+ "        </role>"+ "      </roles>"+ "</security>"+ "</server>"+ "<pipelines group=\"first\">\n"+ "<authorization>"+ "     <admins>\n"+ "         <role>bar</role>\n"+ "      </admins>"+ "</authorization>"+ "<pipeline name='pipeline1' template='abc'>\n"+ "    <materials>\n"+ "      <svn url =\"svnurl\"/>"+ "    </materials>\n"+ "</pipeline>\n"+ "</pipelines>\n"+ "<templates>\n"+ "  <pipeline name='abc'>\n"+ "    <stage name='stage1'>"+ "      <jobs>"+ "        <job name='job1' />"+ "      </jobs>"+ "    </stage>"+ "  </pipeline>\n"+ "</templates>\n"+ "</cruise>";
  CruiseConfig cruiseConfig=ConfigMigrator.loadWithMigration(content).config;
  assertThat(cruiseConfig.schemaVersion(),is(CONFIG_SCHEMA_VERSION));
  assertThat(cruiseConfig.findGroup("first").isUserAnAdmin(new CaseInsensitiveString("foo"),asList(new Role(new CaseInsensitiveString("bar")))),is(true));
}
