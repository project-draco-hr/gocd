{
  if (virtual) {
    return new AgentInstance(agentConfig,AgentType.VIRTUAL,systemEnvironment);
  }
 else   if (agentConfig.isFromLocalHost()) {
    AgentInstance local=new AgentInstance(agentConfig,AgentType.LOCAL,systemEnvironment);
    local.agentConfigStatus=AgentConfigStatus.Enabled;
    local.agentRuntimeInfo.idle();
    return local;
  }
 else {
    return new AgentInstance(agentConfig,AgentType.REMOTE,systemEnvironment);
  }
}
