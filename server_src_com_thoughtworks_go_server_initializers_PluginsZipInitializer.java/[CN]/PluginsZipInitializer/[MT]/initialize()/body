{
  if (!systemEnvironment.get(SystemEnvironment.PLUGIN_FRAMEWORK_ENABLED)) {
    return;
  }
  try {
    File bundledPlugins=new File(systemEnvironment.get(SystemEnvironment.PLUGIN_GO_PROVIDED_PATH));
    File externalPlugins=new File(systemEnvironment.get(SystemEnvironment.PLUGIN_EXTERNAL_PROVIDED_PATH));
    ZipBuilder zipBuilder=zipUtil.zipContentsOfMultipleFolders(new File(systemEnvironment.get(SystemEnvironment.ALL_PLUGINS_ZIP_PATH)),true);
    zipBuilder.add("bundled",bundledPlugins).add("external",externalPlugins).done();
  }
 catch (  Exception e) {
    LOG.error("Could not create zip of plugins for agent to download.",e);
  }
}
