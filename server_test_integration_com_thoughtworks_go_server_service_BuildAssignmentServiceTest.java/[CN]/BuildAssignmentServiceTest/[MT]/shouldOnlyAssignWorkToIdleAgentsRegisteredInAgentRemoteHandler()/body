{
  AgentConfig agentConfig=AgentMother.remoteAgent();
  configHelper.addAgent(agentConfig);
  fixture.createPipelineWithFirstStageScheduled();
  AgentRuntimeInfo info=AgentRuntimeInfo.fromServer(agentConfig,true,"location",1000000l,"OS");
  info.setCookie("cookie");
  AgentStatus[] statuses=new AgentStatus[]{AgentStatus.Building,AgentStatus.Pending,AgentStatus.Disabled,AgentStatus.Disabled,AgentStatus.LostContact,AgentStatus.Missing};
  for (  AgentStatus status : statuses) {
    info.setStatus(status);
    final List<Action> actions=new ArrayList<Action>();
    Agent agent=createWebsocketAgent(actions);
    agentRemoteHandler.process(agent,new Ping(info));
    buildAssignmentService.onTimer();
    assertThat("Should not assign work when agent status is " + status,actions.size(),is(0));
  }
}
