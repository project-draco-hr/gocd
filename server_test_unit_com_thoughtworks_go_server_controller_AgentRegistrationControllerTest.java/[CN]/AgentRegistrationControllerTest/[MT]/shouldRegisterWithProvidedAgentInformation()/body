{
  when(goConfigService.hasAgent("blahAgent-uuid")).thenReturn(false);
  ServerConfig serverConfig=new ServerConfig("artifacts",new SecurityConfig(),10,20,"1",null);
  when(goConfigService.serverConfig()).thenReturn(serverConfig);
  controller.agentRequest("blahAgent-host","blahAgent-uuid","blah-location","34567","osx","","","","",request);
  verify(agentService).requestRegistration(AgentRuntimeInfo.fromServer(new AgentConfig("blahAgent-uuid","blahAgent-host",request.getRemoteAddr()),false,"blah-location",34567L,"osx"));
}
