{
  String chosenAppServer=System.getProperty(SystemEnvironment.APP_SERVER.propertyName());
  if (chosenAppServer == null || chosenAppServer.trim().isEmpty()) {
    systemEnvironment.set(SystemEnvironment.APP_SERVER,SystemEnvironment.JETTY6);
  }
  Constructor<?> constructor=Class.forName(systemEnvironment.get(SystemEnvironment.APP_SERVER)).getConstructor(SystemEnvironment.class,String.class,SSLSocketFactory.class);
  AppServer server=((AppServer)constructor.newInstance(systemEnvironment,password,sslSocketFactory));
  server.configure();
  server.addExtraJarsToClasspath(getExtraJarsToBeAddedToClasspath());
  server.setCookieExpirePeriod(twoWeeks());
  server.setInitParameter("rails.root","/WEB-INF/rails.new");
  server.addStopServlet();
  return server;
}
