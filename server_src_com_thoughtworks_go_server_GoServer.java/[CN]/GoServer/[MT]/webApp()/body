{
  WebAppContext wac=new WebAppContext();
  configuration.setWebAppContext(wac);
  configuration.initialize(getWarFile());
  wac.setConfigurationClasses(new String[]{"org.mortbay.jetty.webapp.WebInfConfiguration","org.mortbay.jetty.webapp.WebXmlConfiguration","org.mortbay.jetty.webapp.JettyWebXmlConfiguration"});
  wac.setContextPath(new SystemEnvironment().getWebappContextPath());
  wac.setWar(getWarFile());
  wac.setParentLoaderPriority(new SystemEnvironment().getParentLoaderPriority());
  setCookieExpireIn2Weeks(wac);
  addExtraJarsToClasspath(wac);
  addJRubyContextInitParams(wac);
  addStopServlet(wac);
  return wac;
}
