{
  MaterialRevisions revisions=ModificationsMother.createHgMaterialRevisions();
  Modification latestModification=new Modification("user2","comment2","email2",new Date(),"122cf27f16eadc362733328dd481d8a2c29915e1");
  latestModification.createModifiedFile("file","folder",ModifiedAction.added);
  revisions.getRevisions().get(0).getModifications().add(0,latestModification);
  String encode=JsonMessage.encode(new Message(Action.ping,revisions));
  Message decode=JsonMessage.decode(encode);
  MaterialRevisions data=(MaterialRevisions)decode.getData();
  MaterialRevision revision=data.getRevisions().get(0);
  assertThat(revision.getRevision(),is(revisions.getRevisions().get(0).getRevision()));
  assertThat(revision.getModifications().size(),is(1));
}
