{
  configHelper=new GoConfigFileHelper(CONFIG);
  SystemEnvironment env=new SystemEnvironment();
  ConfigRepository configRepository=new ConfigRepository(env);
  configRepository.initialize();
  dataSource=new GoConfigDataSource(new DoNotUpgrade(),configRepository,env,new TimeProvider(),new ConfigCache(),new ServerVersion(),ConfigElementImplementationRegistryMother.withNoPlugins(),metricsProbeService,serverHealthService);
  serverHealthService=new ServerHealthService();
  cachedGoConfig=new CachedGoConfig(dataSource,serverHealthService);
  cachedGoConfig.loadConfigIfNull();
  configHelper.usingCruiseConfigDao(new GoConfigFileDao(cachedGoConfig,mock(MetricsProbeService.class)));
}
