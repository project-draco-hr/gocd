{
  PipelineConfig pipeline=pipelineWithTemplate();
  when(goConfigDao.loadForEditing()).thenReturn(configWith(pipeline));
  try {
    goConfigService.buildSaver("pipeline","stage",0).asXml();
    fail("shouldThrowExceptionWhenSavingJobToPipelineWithTemplate");
  }
 catch (  Exception e) {
    assertThat(e.getMessage(),is("Pipeline 'pipeline' references template 'foo'. Cannot edit job."));
  }
}
