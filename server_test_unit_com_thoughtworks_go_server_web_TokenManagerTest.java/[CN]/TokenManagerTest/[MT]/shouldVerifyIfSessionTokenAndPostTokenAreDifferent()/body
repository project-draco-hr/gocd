{
  when(request.getParameter(TOKEN)).thenReturn("random.token");
  when(request.getSession()).thenReturn(session);
  when(session.getAttribute(TOKEN)).thenReturn("token");
  assertThat(manager.verify(request),is(false));
  verify(request).getParameter(TOKEN);
  verify(request).getSession();
  verify(session).getAttribute(TOKEN);
}
