{
  File uploadingFile=mock(File.class);
  java.util.Properties checksums=new java.util.Properties();
  String uploadUrl="url";
  PostMethod mockPostMethod=mock(PostMethod.class);
  when(uploadingFile.exists()).thenReturn(true);
  when(httpClientFactory.createPost(uploadUrl)).thenReturn(mockPostMethod);
  service.upload(uploadUrl,100L,uploadingFile,checksums);
  verify(mockPostMethod).setRequestHeader(GO_ARTIFACT_PAYLOAD_SIZE,"100");
  verify(httpClientFactory).createMultipartRequestEntity(uploadingFile,checksums,null);
  verify(httpClient).executeMethod(mockPostMethod);
}
