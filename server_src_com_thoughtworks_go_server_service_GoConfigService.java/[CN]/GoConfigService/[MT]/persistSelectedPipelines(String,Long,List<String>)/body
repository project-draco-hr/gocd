{
  PipelineSelections pipelineSelections=findOrCreateCurrentPipelineSelectionsFor(id,userId);
  if (pipelineSelections.isBlacklist()) {
    List<String> unselectedPipelines=invertSelections(selectedPipelines);
    pipelineSelections.update(unselectedPipelines,clock.currentTime(),userId);
  }
 else {
    pipelineSelections.update(selectedPipelines,clock.currentTime(),userId);
  }
  return pipelineRepository.saveSelectedPipelines(pipelineSelections);
}
