{
  GoConfigDao.CompositeConfigCommand command=new GoConfigDao.CompositeConfigCommand();
  for (  AgentInstance agentInstance : instances) {
    String uuid=agentInstance.getUuid();
    if (hasAgent(uuid)) {
      command.addCommand(GoConfigDao.updateApprovalStatus(uuid,disabled));
    }
 else {
      AgentConfig agentConfig=agentInstance.agentConfig();
      agentConfig.disable(disabled);
      command.addCommand(GoConfigDao.createAddAgentCommand(agentConfig));
    }
  }
  updateConfig(command);
}
