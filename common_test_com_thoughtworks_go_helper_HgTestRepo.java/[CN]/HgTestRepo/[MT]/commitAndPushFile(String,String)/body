{
  File baseDir=TestFileUtil.createUniqueTempFolder("working-dir");
  HgMaterial material=material();
  Revision tip=latestRevision(material,baseDir,new TestSubprocessExecutionContext());
  material.updateTo(ProcessOutputStreamConsumer.inMemoryConsumer(),tip,baseDir,new TestSubprocessExecutionContext());
  File file=new File(baseDir,fileName);
  file.createNewFile();
  material.add(baseDir,ProcessOutputStreamConsumer.inMemoryConsumer(),new File(baseDir,fileName));
  material.commit(baseDir,ProcessOutputStreamConsumer.inMemoryConsumer(),comment,"user");
  material.push(baseDir,ProcessOutputStreamConsumer.inMemoryConsumer());
  return material.latestModification(baseDir,new TestSubprocessExecutionContext());
}
