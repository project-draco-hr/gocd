{
  String entryName=nonRootedEntryName(entry);
  File outputFile=new File(toDir,entryName);
  if (isDirectory(entryName)) {
    outputFile.mkdirs();
    return;
  }
  FileOutputStream os=null;
  try {
    outputFile.getParentFile().mkdirs();
    os=new FileOutputStream(outputFile);
    IOUtils.copyLarge(entryInputStream,os);
    if (zipEntryHandler != null) {
      FileInputStream stream=null;
      try {
        stream=new FileInputStream(outputFile);
        zipEntryHandler.handleEntry(entry,stream);
      }
  finally {
        if (stream != null) {
          stream.close();
        }
      }
    }
  }
  finally {
    IOUtils.closeQuietly(os);
  }
}
