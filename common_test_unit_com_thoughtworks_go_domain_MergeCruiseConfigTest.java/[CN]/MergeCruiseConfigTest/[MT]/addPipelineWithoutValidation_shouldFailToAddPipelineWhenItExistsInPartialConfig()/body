{
  pipelines=new BasicPipelineConfigs("group_main",new Authorization(),PipelineConfigMother.pipelineConfig("pipe1"));
  pipelines.setOrigin(new FileConfigOrigin());
  BasicCruiseConfig mainCruiseConfig=new BasicCruiseConfig(pipelines);
  cruiseConfig=new BasicCruiseConfig(mainCruiseConfig,PartialConfigMother.withPipeline("pipe2"));
  try {
    cruiseConfig.addPipelineWithoutValidation("group_main",PipelineConfigMother.pipelineConfig("pipe2"));
    fail("should have thrown when trying to add pipe2 when it already exists in partial config");
  }
 catch (  Exception ex) {
    assertThat(ex.getMessage(),containsString("Pipeline called 'pipe2' is already defined in configuration repository"));
  }
}
