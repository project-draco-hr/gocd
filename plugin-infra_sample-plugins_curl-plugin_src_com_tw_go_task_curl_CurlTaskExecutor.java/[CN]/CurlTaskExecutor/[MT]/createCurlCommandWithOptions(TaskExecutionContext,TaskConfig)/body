{
  String requestType=taskConfig.getValue(CurlTask.REQUEST_PROPERTY);
  String secureConnection=taskConfig.getValue(CurlTask.SECURE_CONNECTION_PROPERTY);
  String additionalOptions=taskConfig.getValue(CurlTask.ADDITIONAL_OPTIONS);
  String destinationFilePath=taskContext.workingDir() + "/" + CURLED_FILE;
  String url=taskConfig.getValue(CurlTask.URL_PROPERTY);
  List<String> command=new ArrayList<String>();
  command.add("curl");
  command.add(requestType);
  if (secureConnection.equals("no")) {
    command.add("--insecure");
  }
  if (additionalOptions != null && !additionalOptions.trim().isEmpty()) {
    String parts[]=additionalOptions.split("\\s+");
    for (    String part : parts) {
      command.add(part);
    }
  }
  command.add("-o");
  command.add(destinationFilePath);
  command.add(url);
  return new ProcessBuilder(command);
}
