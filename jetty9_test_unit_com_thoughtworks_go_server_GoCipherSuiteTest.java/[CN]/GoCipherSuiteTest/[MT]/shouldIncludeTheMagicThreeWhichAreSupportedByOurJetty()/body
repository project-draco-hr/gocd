{
  SSLSocketFactory socketFactory=mock(SSLSocketFactory.class);
  when(socketFactory.getSupportedCipherSuites()).thenReturn(new String[]{"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256","TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256","TLS_RSA_WITH_AES_128_CBC_SHA256","SSL_RSA_WITH_RC4_128_SHA","TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256","TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256","TLS_DHE_RSA_WITH_AES_128_CBC_SHA256","SSL_RSA_EXPORT_WITH_RC4_40_MD5","TLS_DHE_DSS_WITH_AES_128_CBC_SHA256","TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA","SSL_RSA_WITH_RC4_128_MD5","TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA"});
  GoCipherSuite goCipherSuite=new GoCipherSuite(socketFactory);
  assertThat(Arrays.asList(goCipherSuite.getCipherSuitsToBeIncluded()),is(Arrays.asList("SSL_RSA_WITH_RC4_128_SHA","SSL_RSA_EXPORT_WITH_RC4_40_MD5","SSL_RSA_WITH_RC4_128_MD5")));
}
