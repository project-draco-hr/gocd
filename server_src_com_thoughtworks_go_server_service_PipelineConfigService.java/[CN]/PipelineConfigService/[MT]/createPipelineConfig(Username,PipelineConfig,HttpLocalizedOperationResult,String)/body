{
  try {
    goConfigService.updatePipeline(pipelineConfig,currentUser,result,new SaveCommand<PipelineConfig>(){
      @Override public boolean isValid(      CruiseConfig preprocessedConfig,      PipelineConfig preprocessedPipelineConfig){
        boolean isValid=preprocessedPipelineConfig.validateTree(PipelineConfigSaveValidationContext.forChain(true,groupName,preprocessedConfig,preprocessedPipelineConfig));
        if (!isValid)         BasicCruiseConfig.copyErrors(preprocessedPipelineConfig,pipelineConfig);
        return isValid;
      }
      @Override public boolean hasWritePermissions(){
        if (goConfigService.groups().hasGroup(groupName) && !goConfigService.isUserAdminOfGroup(currentUser.getUsername(),groupName)) {
          result.unauthorized(LocalizedMessage.string("UNAUTHORIZED_TO_EDIT_GROUP",groupName),HealthStateType.unauthorised());
          return false;
        }
        return true;
      }
      @Override public String getPipelineGroup(){
        return groupName;
      }
      @Override public void updateConfig(      CruiseConfig configForEdit,      PipelineConfig pipelineConfig){
        configForEdit.addPipelineWithoutValidation(groupName,pipelineConfig);
      }
    }
);
  }
 catch (  Exception e) {
    LOGGER.error(e.getMessage(),e);
    result.internalServerError(LocalizedMessage.string("SAVE_FAILED_WITH_REASON",e.getMessage()));
  }
}
