{
  if (!hasOperatePermission(username,result)) {
    return;
  }
  AgentInstance agentInstance=findAgent(uuid);
  if (isUnknownAgent(agentInstance,result)) {
    return;
  }
  try {
    agentConfigService.updateAgentAttributes(uuid,username.getUsername().toString(),newHostname,resources);
    result.ok(String.format("Updated agent with uuid %s.",uuid));
  }
 catch (  GoConfigInvalidException e) {
    result.unprocessibleEntity("Updating agents failed",e.getMessage(),HealthStateType.general(HealthStateScope.GLOBAL));
  }
catch (  Exception e) {
    result.internalServerError("Updating agents failed: " + e.getMessage(),HealthStateType.general(HealthStateScope.GLOBAL));
  }
}
