{
  final List<ProjectStatus> projectStatuses=new ArrayList<ProjectStatus>();
  final Map<String,Set<String>> groupsAndTheirViewers=ccTrayViewAuthority.groupsAndTheirViewers();
  config.accept(new PipelineGroupVisitor(){
    @Override public void visit(    PipelineConfigs pipelineConfigs){
      Set<String> usersWithViewPermissionsOfThisGroup=groupsAndTheirViewers.get(pipelineConfigs.getGroup());
      for (      PipelineConfig pipelineConfig : pipelineConfigs) {
        for (        StageConfig stageConfig : pipelineConfig) {
          List<ProjectStatus> statusesInCacheOrDB=findExistingStatuses(pipelineConfig,stageConfig);
          List<ProjectStatus> statuses=getStatusesForCurrentProjectsWithDefaultsForMissingOnes(pipelineConfig,stageConfig,statusesInCacheOrDB);
          updateStatusesWithUsersHavingViewPermission(statuses,usersWithViewPermissionsOfThisGroup);
          projectStatuses.addAll(statuses);
        }
      }
    }
    private List<ProjectStatus> findExistingStatuses(    PipelineConfig pipelineConfig,    StageConfig stageConfig){
      if (cache.get(stageProjectName(pipelineConfig,stageConfig)) != null) {
        return findStageAndStatusesFromCache(pipelineConfig,stageConfig);
      }
 else {
        return findStageAndStatusesFromDB(pipelineConfig,stageConfig);
      }
    }
  }
);
  return projectStatuses;
}
