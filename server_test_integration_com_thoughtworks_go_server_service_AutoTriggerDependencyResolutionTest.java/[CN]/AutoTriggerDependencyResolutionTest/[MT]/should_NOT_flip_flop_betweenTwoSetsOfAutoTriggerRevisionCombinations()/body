{
  GitMaterial git=u.wf(new GitMaterial("git"),"folder1");
  String[] git_revs={"g1"};
  u.checkinInOrder(git,git_revs);
  ScheduleTestUtil.AddedPipeline p1=u.saveConfigWith("P1",u.m(git));
  ScheduleTestUtil.AddedPipeline p2=u.saveConfigWith("P2",u.m(git));
  ScheduleTestUtil.AddedPipeline p3=u.saveConfigWith("P3",u.m(p1),u.m(p2),u.m(git));
  CruiseConfig cruiseConfig=goConfigDao.load();
  int i=0;
  int extraHours18=i++;
  String p1_1=u.runAndPassWithGivenMDUTimestampAndRevisionStrings(p1,u.d(extraHours18),"g1");
  int extraHours17=i++;
  String p2_1=u.runAndPassWithGivenMDUTimestampAndRevisionStrings(p2,u.d(extraHours17),"g1");
  int extraHours16=i++;
  String p3_1=u.runAndPassWithGivenMDUTimestampAndRevisionStrings(p3,u.d(extraHours16),p1_1,p2_1,"g1");
  int extraHours15=i++;
  u.checkinInOrder(git,u.d(extraHours15),"g2");
  int extraHours14=i++;
  String p2_2=u.runAndPassWithGivenMDUTimestampAndRevisionStrings(p2,u.d(extraHours14),"g2");
  int extraHours13=i++;
  u.checkinInOrder(git,u.d(extraHours13),"g3");
  int extraHours12=i++;
  String p1_2=u.runAndPassWithGivenMDUTimestampAndRevisionStrings(p1,u.d(extraHours12),"g3");
  int extraHours11=i++;
  u.checkinInOrder(git,u.d(extraHours11),"g4");
  int extraHours10=i++;
  String p2_3=u.runAndPassWithGivenMDUTimestampAndRevisionObjects(p2,u.d(extraHours10),u.rs("g3","g4"));
  int extraHours9=i++;
  u.checkinInOrder(git,u.d(extraHours9),"g5");
  int extraHours8=i++;
  String p1_3=u.runAndPassWithGivenMDUTimestampAndRevisionObjects(p1,u.d(extraHours8),u.rs("g4","g5"));
  int extraHours7=i++;
  String p2_4=u.runAndPassWithGivenMDUTimestampAndRevisionStrings(p2,u.d(extraHours7),"g5");
  int extraHours6=i++;
  List<String> revsForP1=u.revisions(p1_3);
  List<String> revsForP2=u.revisions(p2_4);
  List<String> revsForGit=u.revisions("g2","g3","g4","g5");
  String p3_2=u.runAndPassWithGivenMDUTimestampAndRevisionObjects(p3,u.d(extraHours6),u.getRevisionsForMaterials(revsForP1,revsForP2,revsForGit));
  int extraHours5=i++;
  u.checkinInOrder(git,u.d(extraHours5),"g6");
  int extraHours4=i++;
  String p2_5=u.runAndPassWithGivenMDUTimestampAndRevisionStrings(p2,u.d(extraHours4),"g6");
  int extraHours3=i++;
  u.checkinInOrder(git,u.d(extraHours3),"g7");
  int extraHours2=i++;
  String p1_4=u.runAndPassWithGivenMDUTimestampAndRevisionObjects(p1,u.d(extraHours2),u.rs("g6","g7"));
  int extraHours1=i++;
  String p2_6=u.runAndPassWithGivenMDUTimestampAndRevisionStrings(p2,u.d(extraHours1),"g3");
  int extraHours=i++;
  String p3_3=u.runAndPassWithGivenMDUTimestampAndRevisionStrings(p3,u.d(extraHours),p1_2,p2_6,"g3");
  MaterialRevisions given=u.mrs(u.mr(p1,true,p1_4),u.mr(p2,false,p2_6),u.mr(git,true,"g7"));
  MaterialRevisions previous=u.mrs(new MaterialRevision[]{u.mr(p1,true,p1_2),u.mr(p2,false,p2_6),u.mr(git,true,"g3")});
  pipelineTimeline.update();
  AutoBuild autoBuild=new AutoBuild(goConfigService,pipelineService,"P3",systemEnvironment,materialChecker,serverHealthService);
  assertThat(autoBuild.onModifications(given,false,previous),nullValue());
}
